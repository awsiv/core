 <div id="wholebody"><div id="pagebody"><div class="rtop"><div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div></div><div id="content">
<pre>
<h1>Cfengine 3 example unit_template2.html</h1>

body common control
{
bundlesequence => { "test" };

inputs => { "cfengine_stdlib.cf" };
}

bundle agent test
{
methods:

 "any" usebundle => get_template("/tmp/sudoers","400");
 "any" usebundle => get_template("/tmp/hosts","644");
 
}

#############################################################

bundle agent get_template(final_destination,mode)
{
vars:

 # This needs to ne preconfigured to your site

 "masterfiles"   string => "/home/mark/tmp";
 "this_template" string => lastnode("$(final_destination)","/");

files:

  "$(final_destination).staging"

       comment => "Get template and expand variables for this host",
         perms => mo("400","root"),
     copy_from => remote_cp("$(masterfiles)/templates/$(this_template)","$(policy_server)"),
        action => if_elapsed("60");

  "$(final_destination)"

       comment => "Expand the template",
        create => "true",
     edit_line => expand_template("$(final_destination).staging"),
 edit_defaults => empty,
         perms => mo("$(mode)","root"),
        action => if_elapsed("60");

}
}
</div><div class="rbottom"><div class="r4"></div><div class="r3"></div><div class="r2"></div><div class="r1"></div></div></div></div></div>